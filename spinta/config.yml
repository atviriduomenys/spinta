config:
  type: string

commands:
  type: object
  items:
    modules:
      type: array
      items:
        type: string
    service:
      type: object
      keys:
        type: string
      values:
        type: importstr

ufuncs:
  type: array
  items:
    type: importstr

components:
  type: object
  keys:
    type: string
  values:
    type: object
    keys:
      type: string
    values:
      type: importstr

exporters:
  type: object
  keys:
    type: string
  values:
    type: importstr

accesslog:
  type: object
  items:
    type:
      type: ref
      ref: components.accesslog
    buffer_size:
      type: integer
      default: 300
  switch: type
  case:
    file:
      file:
        type: string
        default: stdout

keymaps:
  type: object
  keys:
    type: string
  values:
    type: object
    items:
      type:
        type: ref
        ref: components.keymaps
      dsn:
        type: string

backends:
  type: object
  keys:
    type: string
  values:
    type: object
    items:
      type:
        type: ref
        ref: components.backends
      dsn:
        type: string
      migrate:
        type: ref
        ref: components.migrations
    switch: type
    case:
      s3:
        bucket:
          type: string
        region:
          type: string
          default: 'eu-north-1'
        access_key_id:
          type: string
        secret_access_key:
          type: string

manifests:
  type: object
  keys:
    type: string
  values:
    type: object
    items:
      type:
        type: ref
        ref: components.manifests
      backend:
        type: ref
        ref: backends
      keymap:
        type: ref
        ref: keymaps
      sync:
        type: ref
        ref: manifests
      mode:
        type: string
        default: internal
    switch: type
    case:
      yaml:
        path:
          type: path
      tabular:
        # File path or a URL that points to a tabular manifest file.
        path:
          type: path
        # Manifest can be passed via pipe or other means as a file-like object.
        file:
          type: io

manifest:
  type: ref
  ref: manifests

# When scanning for manifest YAML files, ignore these files.
ignore:
  type: array
  items:
    type: string

debug:
  type: bool

# How much time to wait in seconds for the backends to go up.
wait:
  type: integer

# Configuration path, where clients, keys and other things are stored.
config_path:
  type: path

# Path to documentation folder. If set will serve the folder at `/docs`.
docs_path:
  type: path

server_url:
  type: url

# This prefix will be added to autogenerated scope names.
scope_prefix:
  type: string

# Part of the scope will be replaced with a hash to fit scope_max_length.
scope_max_length:
  type: integer

# If True, then id property is always included into Action.SEARCH result,
# even if not explicitly askend.
always_show_id:
  type: bool

default_auth_client:
  type: string

check:
  type: object
  items:
    names:
      type: boolean

root:
  type: string

env:
  type: ref
  ref: environments
